#! /bin/bash
SCRIPT_DIR="$( cd -- "$( dirname -- "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )"

echo "Scripts: ${SCRIPT_DIR}"
cd ${SCRIPT_DIR}

echo "Fetching latest config repo"
# junk any existing checked out files
git reset HEAD --hard
git clean -f -x -d
git checkout master
git reset HEAD --hard
git clean -f -x -d
git fetch --recurse-submodules

# NOTE Loses all local commits on master
git reset --hard origin/master
git remote update origin --prune
git prune
git gc --aggressive --prune

echo "Getting latest config repo"
git pull --recurse-submodules

echo "Updating tools"
dotnet tool restore
